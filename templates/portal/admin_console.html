{% extends "base.html" %}

{% block title %}Consolă administrator | OCR Workspace{% endblock %}

{% block content %}
<section class="section-header">
    <div>
        <h1>Consolă administrator</h1>
        <p>Gestionează cererile de acces și acordă permisiuni pe module pentru fiecare utilizator.</p>
    </div>
</section>

<section class="card admin-settings-card">
    <h2>Setări motor OCR</h2>
    <p class="muted">Motorul curent: <strong>{{ portal_settings.get_ocr_engine_display }}</strong></p>
    <form method="post" class="form-grid">
        {% csrf_token %}
        <input type="hidden" name="form_name" value="settings">
        {{ settings_form.non_field_errors }}
        <div class="form-field">
            {{ settings_form.ocr_engine.label_tag }}
            {{ settings_form.ocr_engine }}
            <small class="help-text">{{ settings_form.ocr_engine.help_text }}</small>
            {{ settings_form.ocr_engine.errors }}
        </div>
        <div class="form-actions">
            <button type="submit" class="primary-button">Salvează setarea</button>
        </div>
    </form>
</section>

<section class="admin-console">
    <aside class="admin-console__list">
        <h2>Utilizatori</h2>
        <ul>
            {% for access in access_list %}
                <li class="{% if selected_access and selected_access.id == access.id %}is-active{% endif %}">
                    <a href="{% url 'portal:admin' %}?access_id={{ access.id }}">{{ access.user.username }}</a>
                    <span class="status-chip status-chip--{{ access.status }}">{{ access.get_status_display }}</span>
                </li>
            {% empty %}
                <li class="muted">Nu există utilizatori înregistrați.</li>
            {% endfor %}
        </ul>
    </aside>
    <section class="admin-console__detail">
        {% if selected_access and form %}
            <h2>Editează: {{ selected_access.user.username }}</h2>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="form_name" value="access">
                {{ form.non_field_errors }}
                <div class="form-field">
                    {{ form.status.label_tag }}
                    {{ form.status }}
                </div>
                <div class="form-field">
                    {{ form.allowed_menus.label_tag }}
                    <div class="checkbox-list">
                        {{ form.allowed_menus }}
                    </div>
                </div>
                <div class="form-field">
                    {{ form.notes.label_tag }}
                    {{ form.notes }}
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-button">Salvează</button>
                </div>
            </form>
        {% else %}
            <p class="muted">Selectează un utilizator pentru a edita drepturile de acces.</p>
        {% endif %}
    </section>
</section>
{% endblock %}
