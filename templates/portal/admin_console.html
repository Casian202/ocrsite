{% extends "base.html" %}

{% block title %}Consolă administrator | OCR Workspace{% endblock %}

{% block content %}
<section class="page-header">
    <div class="page-header__text">
        <h1>Consolă administrator</h1>
        <p>Gestionează cererile de acces și configurează modulele disponibile pentru fiecare utilizator.</p>
    </div>
</section>

<section class="surface-card">
    <h2 class="section-title">Setări motor OCR</h2>
    <p class="muted">Motorul curent: <strong>{{ portal_settings.get_ocr_engine_display }}</strong></p>
    <form method="post" class="form-layout">
        {% csrf_token %}
        <input type="hidden" name="form_name" value="settings">
        {{ settings_form.non_field_errors }}
        <div class="form-field">
            {{ settings_form.ocr_engine.label_tag }}
            {{ settings_form.ocr_engine }}
            <small class="help-text">{{ settings_form.ocr_engine.help_text }}</small>
            {{ settings_form.ocr_engine.errors }}
        </div>
        <div class="form-actions">
            <button type="submit" class="btn btn--primary">Salvează setarea</button>
        </div>
    </form>
</section>

<section class="admin-grid">
    <aside class="surface-card admin-sidebar">
        <h2 class="section-title">Utilizatori</h2>
        <ul class="admin-user-list">
            {% for access in access_list %}
                <li class="{% if selected_access and selected_access.id == access.id %}is-active{% endif %}">
                    <a href="{% url 'portal:admin' %}?access_id={{ access.id }}" class="admin-user-link">
                        <span>{{ access.user.username }}</span>
                        <span class="status-chip status-chip--{{ access.status }}">{{ access.get_status_display }}</span>
                    </a>
                </li>
            {% empty %}
                <li class="muted">Nu există utilizatori înregistrați.</li>
            {% endfor %}
        </ul>
    </aside>
    <section class="surface-card">
        {% if selected_access and form %}
            <h2 class="section-title">Editează: {{ selected_access.user.username }}</h2>
            <form method="post" class="form-layout">
                {% csrf_token %}
                <input type="hidden" name="form_name" value="access">
                {{ form.non_field_errors }}
                <div class="form-field">
                    {{ form.status.label_tag }}
                    {{ form.status }}
                </div>
                <div class="form-field">
                    {{ form.allowed_menus.label_tag }}
                    {{ form.allowed_menus }}
                </div>
                <div class="form-field">
                    {{ form.notes.label_tag }}
                    {{ form.notes }}
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn--primary">Salvează</button>
                </div>
            </form>
        {% else %}
            <p class="muted">Selectează un utilizator din lista din stânga pentru a edita drepturile de acces.</p>
        {% endif %}
    </section>
</section>
{% endblock %}
