{% extends "base.html" %}

{% block title %}Word Studio | OCR Workspace{% endblock %}

{% block content %}
<section class="page-header">
    <div class="page-header__text">
        <h1>Word Studio</h1>
        <p>Creează documente .docx sau convertește rapid PDF-uri procesate în fișiere Word editabile.</p>
        <p class="muted">Conversiile folosesc motorul <strong>{{ engine_label }}</strong> configurat în consola de administrare.</p>
        {% if engine_key == 'docling' %}
            <p class="muted">Docling poate simplifica formatările complexe față de OCRmyPDF.</p>
        {% endif %}
    </div>
</section>

<section class="page-grid">
    <article class="surface-card">
        <h2>Document Word nou</h2>
        <form method="post" class="form-layout">
            {% csrf_token %}
            {{ create_form.non_field_errors }}
            <div class="form-field">
                {{ create_form.title.label_tag }}
                {{ create_form.title }}
            </div>
            <div class="form-field">
                {{ create_form.body.label_tag }}
                {{ create_form.body }}
            </div>
            <div class="form-actions">
                <button type="submit" name="create_word" class="btn btn--primary">Generează document</button>
            </div>
        </form>
    </article>
    <article class="surface-card">
        <h2>Conversie PDF &rarr; Word</h2>
        <form method="post" enctype="multipart/form-data" class="form-layout">
            {% csrf_token %}
            {{ convert_form.non_field_errors }}
            <div class="form-field">
                {{ convert_form.title.label_tag }}
                {{ convert_form.title }}
            </div>
            <div class="form-field">
                {{ convert_form.pdf_file.label_tag }}
                {{ convert_form.pdf_file }}
            </div>
            <div class="form-actions">
                <button type="submit" name="convert_pdf" class="btn btn--ghost">Convertește PDF</button>
            </div>
        </form>
    </article>
</section>

<section class="surface-card">
    <h2 class="section-title">Documentele tale Word</h2>
    {% if documents %}
        <div class="document-list">
            {% for doc in documents %}
                <div class="job-card job-card--static">
                    <div class="job-card__meta">
                        <h3>{{ doc.title }}</h3>
                        <p>Creat {{ doc.created_at|date:"d.m.Y H:i" }}</p>
                    </div>
                    <div class="job-actions">
                        <a href="{% url 'portal:download_word' doc.id %}" class="btn btn--primary">Descarcă DOCX</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="muted">Nu există documente Word generate încă.</p>
    {% endif %}
</section>
{% endblock %}
