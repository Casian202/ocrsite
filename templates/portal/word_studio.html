{% extends "base.html" %}

{% block title %}Word Studio | OCR Workspace{% endblock %}

{% block content %}
<section class="section-header">
    <div>
        <h1>Word Studio</h1>
        <p>Creează documente .docx sau convertește PDF-uri procesate în fișiere Word editabile.</p>
        <p class="muted">Conversiile folosesc motorul <strong>{{ engine_label }}</strong> selectat în consola de administrare.</p>
        {% if engine_key == 'docling' %}
            <p class="muted">Textul extras poate fi diferit față de OCRmyPDF, iar formatările complexe pot fi simplificate.</p>
        {% endif %}
    </div>
</section>

<section class="card-grid">
    <article class="card">
        <h2>Document Word nou</h2>
        <form method="post">
            {% csrf_token %}
            {{ create_form.non_field_errors }}
            <div class="form-field">
                {{ create_form.title.label_tag }}
                {{ create_form.title }}
            </div>
            <div class="form-field">
                {{ create_form.body.label_tag }}
                {{ create_form.body }}
            </div>
            <div class="form-actions">
                <button type="submit" name="create_word" class="primary-button">Generează document</button>
            </div>
        </form>
    </article>
    <article class="card">
        <h2>Conversie PDF &rarr; Word</h2>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ convert_form.non_field_errors }}
            <div class="form-field">
                {{ convert_form.title.label_tag }}
                {{ convert_form.title }}
            </div>
            <div class="form-field">
                {{ convert_form.pdf_file.label_tag }}
                {{ convert_form.pdf_file }}
            </div>
            <div class="form-actions">
                <button type="submit" name="convert_pdf" class="chip-button">Convertește PDF</button>
            </div>
        </form>
    </article>
</section>

<section class="card">
    <h2>Documentele tale Word</h2>
    {% if documents %}
        <div class="document-list">
            {% for doc in documents %}
                <div class="document-item">
                    <div>
                        <h3>{{ doc.title }}</h3>
                        <p class="muted">Creat {{ doc.created_at|date:"d.m.Y H:i" }}</p>
                    </div>
                    <div class="document-actions">
                        <a href="{% url 'portal:download_word' doc.id %}" class="chip-button">Descarcă DOCX</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="muted">Nu există documente Word generate încă.</p>
    {% endif %}
</section>
{% endblock %}
