{% extends "base.html" %}

{% block title %}{{ folder.name }} | Biblioteci{% endblock %}

{% block content %}
<section class="page-header">
    <div class="page-header__text">
        <a href="{% url 'portal:libraries' %}" class="btn btn--ghost" style="margin-bottom: var(--space-4);">&larr; Înapoi la biblioteci</a>
        <h1>{{ folder.name }}</h1>
        {% if folder.description %}
            <p>{{ folder.description }}</p>
        {% endif %}
    </div>
    <div class="folder-toolbar__actions">
        <a
            href="{% url 'portal:download_library_archive' folder.id %}"
            class="btn btn--primary"
            aria-label="Descarcă folderul ca arhivă ZIP"
        >
            Descarcă arhiva folderului
        </a>
    </div>
    <div class="section-header__actions">
        <a
            href="{% url 'portal:download_library_archive' folder.id %}"
            class="chip-button"
            aria-label="Descarcă folderul ca arhivă ZIP"
            title="Descarcă folderul ca arhivă ZIP"
        >
            <svg aria-hidden="true" focusable="false" viewBox="0 0 24 24">
                <path d="M12 2a1 1 0 0 1 1 1v10.586l2.293-2.293a1 1 0 0 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 1 1 1.414-1.414L11 13.586V3a1 1 0 0 1 1-1zm-7 14a1 1 0 0 1 1 1v2h12v-2a1 1 0 1 1 2 0v3a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1z" />
            </svg>
            <span>Descarcă folder</span>
        </a>
    </div>
</section>

<section class="surface-card">
    <div class="folder-toolbar">
        <h2 class="section-title">Documente în folder</h2>
        <span class="status-chip">{{ documents|length }} fișiere procesate</span>
    </div>
    {% if documents %}
        <table class="table-card">
            <thead>
                <tr>
                    <th>Titlu</th>
                    <th>Creat</th>
                    <th>Status OCR</th>
                    <th style="text-align:right;">Acțiuni</th>
                </tr>
            </thead>
            <tbody>
                {% for document in documents %}
                    <tr>
                        <td>{{ document.title }}</td>
                        <td>{{ document.created_at|date:"d.m.Y H:i" }}</td>
                        <td>{% if document.ocr_job %}{{ document.ocr_job.get_status_display }}{% else %}-{% endif %}</td>
                        <td style="text-align:right; display:flex; justify-content:flex-end; gap:var(--space-3);">
                            <a href="{% url 'portal:preview' document.id %}" class="btn btn--ghost">Previzualizează</a>
                            {% if document.processed_file %}
                                <a href="{% url 'portal:download_document' document.id %}" class="btn btn--primary">Descarcă PDF</a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="muted">Acest folder nu conține încă documente procesate.</p>
    {% endif %}
</section>
{% endblock %}
